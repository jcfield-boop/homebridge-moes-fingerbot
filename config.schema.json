{
  "pluginAlias": "MoesFingerbot",
  "pluginType": "accessory",
  "singular": false,
  "headerDisplay": "Homebridge plugin for MOES Fingerbot devices. Device ID and Local Key are required for Tuya BLE communication.",
  "footerDisplay": "For help finding your device address, use a Bluetooth scanner app. Use tuya-local-key-extractor or similar tools to get your Device ID and Local Key.",
  "schema": {
    "type": "object",
    "properties": {
      "name": {
        "title": "Name",
        "type": "string",
        "default": "MOES Fingerbot",
        "required": true,
        "description": "The name of this accessory as it will appear in HomeKit"
      },
      "address": {
        "title": "Bluetooth Address",
        "type": "string",
        "required": true,
        "pattern": "^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$",
        "description": "The Bluetooth MAC address of your Fingerbot device (format: XX:XX:XX:XX:XX:XX)"
      },
      "deviceId": {
        "title": "Device ID",
        "type": "string",
        "required": true,
        "description": "Tuya device ID (required for encrypted BLE communication)"
      },
      "localKey": {
        "title": "Local Key",
        "type": "string",
        "required": true,
        "description": "Tuya local encryption key (required for encrypted BLE communication)"
      },
      "pressTime": {
        "title": "Press Duration",
        "type": "integer",
        "default": 3000,
        "minimum": 500,
        "maximum": 10000,
        "description": "How long the button stays 'pressed' in HomeKit (milliseconds)"
      },
      "advanced": {
        "title": "Advanced Settings",
        "type": "object",
        "expandable": true,
        "expanded": false,
        "properties": {
          "scanDuration": {
            "title": "Scan Duration",
            "type": "integer",
            "default": 5000,
            "minimum": 1000,
            "maximum": 30000,
            "description": "How long to scan for the device (milliseconds)"
          },
          "scanRetries": {
            "title": "Scan Retries",
            "type": "integer",
            "default": 3,
            "minimum": 1,
            "maximum": 10,
            "description": "Number of scan attempts before giving up"
          },
          "scanRetryCooldown": {
            "title": "Retry Cooldown",
            "type": "integer",
            "default": 1000,
            "minimum": 500,
            "maximum": 10000,
            "description": "Delay between scan retries (milliseconds)"
          },
          "batteryCheckInterval": {
            "title": "Battery Check Interval",
            "type": "integer",
            "default": 60,
            "minimum": 1,
            "maximum": 1440,
            "description": "How often to check battery level (minutes)"
          }
        }
      }
    },
    "required": ["name", "address", "deviceId", "localKey"]
  },
  "layout": [
    {
      "type": "section",
      "title": "Basic Configuration",
      "expandable": false,
      "items": [
        "name",
        "address"
      ]
    },
    {
      "type": "section",
      "title": "Tuya Authentication",
      "expandable": false,
      "items": [
        {
          "type": "help",
          "helpvalue": "<em>These credentials are required for Tuya BLE communication. Use tuya-local-key-extractor or similar tools to obtain them.</em>"
        },
        "deviceId",
        "localKey"
      ]
    },
    {
      "type": "section",
      "title": "Button Settings",
      "expandable": false,
      "items": [
        "pressTime"
      ]
    },
    {
      "type": "section", 
      "title": "Advanced Settings",
      "expandable": true,
      "expanded": false,
      "items": [
        {
          "type": "help",
          "helpvalue": "<em>These settings are optional and only needed for troubleshooting connection issues.</em>"
        },
        {
          "type": "section",
          "title": "Scanning Options",
          "expandable": true,
          "expanded": false,
          "items": [
            "advanced.scanDuration",
            "advanced.scanRetries", 
            "advanced.scanRetryCooldown"
          ]
        },
        {
          "type": "section",
          "title": "Battery Monitoring",
          "expandable": true,
          "expanded": false,
          "items": [
            "advanced.batteryCheckInterval"
          ]
        }
      ]
    }
  ],
  "form": [
    "name",
    "address",
    {
      "type": "fieldset",
      "title": "Tuya Authentication (Required)",
      "expandable": false,
      "items": [
        {
          "type": "help",
          "helpvalue": "These credentials are required for encrypted BLE communication with your Fingerbot device."
        },
        "deviceId",
        "localKey"
      ]
    },
    "pressTime",
    {
      "type": "fieldset", 
      "title": "Connection Settings",
      "expandable": true,
      "expanded": false,
      "items": [
        "advanced.scanDuration",
        "advanced.scanRetries",
        "advanced.scanRetryCooldown"
      ]
    },
    {
      "type": "fieldset",
      "title": "Battery Settings", 
      "expandable": true,
      "expanded": false,
      "items": [
        "advanced.batteryCheckInterval"
      ]
    }
  ]
}